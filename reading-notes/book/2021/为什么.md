---
aliases:
- 为什么
- ^c77d88|三阶段论的典型问题
- ^715655|三阶段论
- ^715655|因果阶梯
authors:
- "[美] 朱迪亚·珀尔"
- "[美] 达纳·麦肯齐"
endTime: "2021-05-12"
startingTime: "2021-04-28"
---

# 为什么

> 作者: \[美\] 朱迪亚·珀尔 / \[美\] 达纳·麦肯齐

> (2021-04-28 \~ 2021-05-12)


## 目录
```
推荐序
前言
导 言：思维胜于数据
第一章：因果关系之梯
第二章：从海盗到豚鼠：因果推断的起源
第三章：从证据到因：当贝叶斯牧师遇见福尔摩斯先生
第四章：混杂和去混杂：或者，消灭潜伏变量
第五章：烟雾缭绕的争论：消除迷雾，澄清事实
第六章：大量的悖论！
第七章：超越调整：征服干预之峰
第八章：反事实：挖掘关于假如的世界
第九章：中介：寻找隐藏的作用机制
第十章：大数据，人工智能和大问题
致谢
参考文献
```

## 主旨

## 关键词
, #person/朱迪亚·珀尔 #达纳 #麦肯齐 #因果性 #因果关系  #复杂 #相关 #统计 #贝叶斯 #网络 #人工智能 #推理 #逻辑 #图灵奖 #意志

## 标记
1. 数万年前,人类开始意识到某些事会导致其他事的发生,并且改变前者就会导致后者的改变.没有其他物种领悟到了这一点,更别说达到我们所理解的这种程度.由这一发现,人类这一物种创造出了有组织的社会,继而建立了乡村和城镇,直至创建了我们今天所享有的科技文明.所有这一切都源于我们的祖先提出了这样一个简单的问题:为什么?
    * 我认为大部分生物都有一定的推理能力.
2. 直到这时,布莱斯·帕斯卡(1654),皮埃尔·德·费马(1654)和克里斯蒂安·惠更斯(1657)这样的数学家才发现有必要建立一门今天我们称之为概率论的数学科学分支.同样,只有当保险机构开始要求准确估算人寿年金保险的时候,爱德蒙·哈雷(1693)和亚伯拉罕·棣莫弗(1725)这样的数学家才开始关注死亡率统计数据,并据此计算出了人的预期寿命.
3. 具有讽刺意味的是,对因果关系理论的需求正是在统计学产生的那一刻浮出水面的.事实上,**现代统计学的创立正源自因果问题——高尔顿和皮尔逊提出了一个关于遗传的因果问题,并独具匠心地尝试用跨代数据来解答它.**遗憾的是,这一努力失败了,他们没有停下来问为什么,反而声称这些问题是禁区,转而去发展另一项刚刚兴起,不涉及因果关系的事业——统计学.
4. **我们知道,禁止言论就意味着禁止了思想,同时也扼杀了与此相关的原则,方法和工具.**
5. 因果革命不是在真空中产生的;它背后有数学工具上的发展作为支撑,这种数学工具最恰当的名称应该是"因果关系演算法".借助这种工具,我们得以解答一些有关因果关系的最棘手的问题.能向公众展示这一演算法实在令我兴奋不已,这不仅是因为它拥有跌宕起伏的发展史,更是因为我真心期待未来某天它能在某些人那里发挥出超出我的想象的潜力……也许就出自本书读者之手.
    * 换个说法就是符号化, 理论化, 数学化.
7. **因果关系演算法由两种语言组成:其一为因果图(causal diagrams),用以表达我们已知的事物,其二为类似代数的符号语言,用以表达我们想知道的事物.**因果图是由简单的点和箭头组成的图,它们能被用于概括现有的某些科学知识.点代表了目标量,我们称之为"变量",箭头代表这些变量之间已知或疑似存在的因果关系,即哪个变量"听从于"哪个变量.这些因果图非常容易绘制,理解和使用,读者将在书中看到许多此类因果图的示例.这么说吧,如果你会使用基于单向街道地图的导航系统,你就一定可以理解因果图,继而就可以独自解决本书导言中提出的那些关于因果关系的问题. 虽然因果图是本书选择使用的主要工具,也是我过去35年的研究主题,但它并不是唯一可用的因果模型.
8. 与图表式的"知识语言"并存的还有一种符号式的"问题语言",它被用于表述我们想要回答的问题.例如,如果我们感兴趣的是药物`(D)`对病人生存期`(L)`的影响,那么我们的问题可以用符号写成:`P(L|do(D))`.换句话说,如果一个身体状况具有足够代表性的病人服用了这种药,那么他在L年内存活的概率`(P)`是多少?这句话所描述的就是被流行病学家称为干预(intervention)或处理(treatment)的概念,其对应于我们在临床试验中所测量的内容.在许多情况下,我们可能还希望对`P(L│do(D))`和`P(L|do(not-D))`进行比较,后者描述的是拒绝接受相应处理\(服药\)的病人,也称"对照组"病人的情况.其中,do算子表明了我们正在进行主动干预而非被动观察,这一概念是经典统计学不可能涉及的.
9. **因果革命最重要的成果之一就是解释了如何在不实际实施干预的情况下预测干预的效果.**如果我们没有首先定义do算子以便提出正确的问题,其次设计出一种在不需要真正实施干预行动的条件下模拟干预行动的方法,那么我们就永远不可能取得这一成就.
10. 当我们感兴趣的科学问题涉及反思性的思考时,我们通常会诉诸另一种类型的表达形式,这种表达形式是因果推断科学独有的,我们称之为"反事实"\(counterfactual\).例如,假设乔在服用了药物D一个月后死亡,那么我们现在关注的问题就是这种药物是否导致了他的死亡.为了回答这个问题,我们需要想象这样一种情况:假如乔在即将服药时改变了主意,他现在会活着吗?
11. 再强调一遍,经典统计学只关注总结数据,因此它甚至无法提供一种语言让我们提出上面那个问题.因果推断则不仅提供了一种表达符号,更重要的是,它还提供了一种解决方案.**这使得我们在预测干预效果时,在多数情况下能够借助一种算法来模拟人类的反思性思考,通过将我们对观测世界的了解输入算法系统,其将输出有关反事实世界的答案.可以说,这种"反事实的算法化"正是因果革命另一项宝贵的成果.**
12. 首先,在人工智能的世界里,只有当你能够教会机器人理解某个课题时,你才算真正理解了它.这就是为何你会在本书看到我反复强调符号,语言,词汇和语法.我痴迷于这样的思考:是否可以用一种业已存在的语言来表达某个论断,以及我们如何判断一个论断是否与其他一些论断相一致.
13. **你无法回答一个你提不出来的问题,你也无法提出一个你的语言不能描述的问题.**作为一名哲学和计算机科学的学生,我之所以被因果推断吸引,最关键的因素就是渴望获得那种亲眼见证一门被边缘化的科学语言促使一门科学从诞生走向成熟这一整个过程所带来的兴奋感. ^138cc6
14. 20世纪80年代末,我意识到智能机器缺乏对因果关系的理解,这也许是妨碍它们发展出相当于人类水平的智能的最大障碍.
15. 我坚信强人工智能是一个可实现的目标,也是一个完全无须恐惧的目标,因为我们在实现它的过程中纳入了因果关系.因果推理模块将使智能机器有能力反思它们的错误,找到自身软件程序中的弱点,并能像一个道德实体那样思考和行动,自然地与人类交流它们自己的选择和意图.
    * 善恶\(或者说道德\)是一个主观感念, 不是一固定标准, 可以随着时间和地点发生改变. 人工智能有能力反思自己的错误, 但错误是谁定义的呢? 机器自己定义的, 那"伤害人类"可能就不是一个错误.
16. 这些模式可被用于测试模型,因此也被称为"可验证的蕴涵"\(testable implications\)  .将"
17. 如果我们的模型显示D和L都依赖于第三变量Z(比如疾病的发展阶段),并且,如果我们没有任何方法可以测量Z的值,那么问题`P(L|do(D))`就无法得到解答.在这种情况下,收集数据完全就是浪费时间.相反,我们需要做的是回过头完善模型,具体方式则是输入新的科学知识,使我们可以估计Z的值,或者简化假设\(注意,此处存在犯错的风险\),例如假设Z对D的影响是可以忽略不计的.
18. 即使这种筛选是随机的,我们也无法避免根据样本测量的概率无法代表整个总体的相应概率的可能性.幸运的是,依靠机器学习领域所提供的先进技术,统计学科为我们提供了很多方法来应对这种不确定性,这些方法包括**最大似然估计,倾向评分,置信区间,显著性检验等.**
19. **我特别想强调数据在上述过程中发挥的作用.首先,请注意,我们是在完成了以下步骤之后才收集的数据:根据假设确定了因果模型,提出了我们想要解决的科学问题,推导出被估量.这与上面提到的传统统计方法形成了鲜明对比,后者甚至没有用到因果模型.**
20. 但是,当今科学界对因果关系的合理推论提出了新的挑战.**尽管科学的快速发展提高了人们对因果模型必要性的认识,许多人工智能领域的研究者仍然想跳过构建因果模型或识别出已有的因果模型这一难度较大的步骤,只依赖数据解决所有的认知难题.他们希望在因果问题出现时,数据本身就能指引他们找到正确的答案——当然,这种想法通常来说都是隐秘不宣的.**
    * 分析因果模型需要耗费大量的精力和时间, 而且这个过程很可能是无趣的.
    * 数据量足够就增加算力.
21. **因为我知道,对于因果关系方面的知识来说,数据没有任何发言权.**
22. 当我们试图回答反事实问题,比如"假如我们采取了相反的行动会发生什么"时,因果模型的重要性就更加引人注目了.我们将非常详细地讨论反事实,因为对任何人工智能来说,反事实问题都是最具挑战性的问题.这类问题也是推动人类认知力和想象力发展的核心,其中前者使我们成为人类,后者使科学成为可能.
23. 本书的第一章将观察,干预和反事实这三个台阶组合成因果关系之梯(ladder of causation),这是本书的核心隐喻.它将向你揭示利用因果图(我们主要的建模工具)进行推理的基本原理,同时引导你一步步成为一名精通因果推理的专家.
24. 本书的第二章将讲述一个匪夷所思的故事:统计学科是如何让自己陷入了因果蒙昧的黑暗,以及这对所有依赖数据的科学产生了怎样深刻的影响
27. 本书的第三章讲述的是一个同样奇妙的故事:我是如何通过对人工智能的研究,特别是对贝叶斯网络的研究,皈依了因果论.贝叶斯网络是让计算机得以在"灰色地带"进行思考的第一个工具,有段时期,我曾坚信它掌握着开启人工智能大门的钥匙.而到了20世纪80年代末,我终于确信自己错了,本章讲述的正是我从贝叶斯倡导者变身为"叛教者"的整段旅程.不过,贝叶斯网络仍然是人工智能领域的一个非常重要的工具,其涵盖了因果图的大部分数学基础.
28. 本书的第四章讲述的是统计学对因果推断的主要贡献:随机对照试验(randomized controlled trial,简称RCT).
29. 本书的第五章将讲述因果论发展史乃至科学史上的一个重要时刻,当时,统计学家纠结于"吸烟是否会导致肺癌"这一问题.
32. 第六章会让读者享受一些轻松时刻.这章的主题是悖论,包括蒙提·霍尔悖论,辛普森悖论,伯克森悖论等.此类经典悖论的确可以当作脑筋急转弯来消遣,但它们也有严肃的一面,尤其是当你从因果的角度来分析它们的时候.事实上,几乎所有这些悖论都体现了某种与因果直觉有关的冲突,从而也揭示出了这种因果直觉的内在构造.这些悖论是一种警示,用以提醒科学家们人类的直觉是根植于因果的,而不是根植于统计和逻辑的.
33. 本书的第七章到第九章将带领读者踏上因果关系之梯激动人心的攀登之旅.我们会从第七章的干预问题入手,讲述我和我的学生们如何历经20年的努力,实现do类型问题解答的自动化.
34. 本书的第八章将通过讨论反事实把你带到因果关系之梯的顶端.反事实被视为因果论的基本组成部分这一认识至少要追溯到1748年,当时苏格兰哲学家大卫·休谟提出了这样一个多少有些别扭的因果定义:"我们可以给一个原因下定义说,它是先行于,接近于另一个对象的一个对象,而且在这里,凡与前一个对象类似的一切对象都和与后一个对象类似的那些对象处在类似的先行关系和接近关系中.或者,换言之,假如没有前一个对象,那么后一个对象就不可能存在."
35. 最后,本书的第九章讨论的主题是中介.在因果图中谈论箭头绘制时,你可能会想,如果药物D只是单纯地通过影响血压Z(中介物)来影响病人的生存期,那么我们是否仍然要从药物D画一个直接指向生存期L的箭头?换言之,D对L的影响是直接的还是间接的?如果两者都有,那么我们如何评估它们的相对重要性?这些问题不仅具有重大的科学意义,而且具有深刻的实际影响:如果我们了解了药物的作用机理,那么我们或许就可以开发出其他效果相同,但价格更低廉或副作用更少的药物.
36. 这一古老的中介机制问题将被简化为一道代数题,而科学家将通过使用因果工具包中的一些新工具轻松解决这些问题.
37. 本书的第十章将通过追溯我本人转向因果研究领域的起始地带领读者走向尾声.正是这个问题,即人类智能的自动化(有时也被称为"强人工智能"是否可能)引导我开始研究因果关系的.
38. 在第100次读<创世记>时,我注意到了一个多年来一直忽略的细节.上帝发现亚当躲在花园里,便问他:"我禁止你碰那棵树,你是不是偷吃了它的果子?"亚当答道:"你所赐给我的与我做伴的女人,她给了我树上的果子,我就吃了.""你都做了什么?"上帝问夏娃.夏娃答道:"那蛇欺骗了我,我就吃了." 众所周知,这种推卸责任的伎俩对全知全能的上帝不起作用,因此他们被逐出了伊甸园.但这里有一点是我以前一直忽略的:**上帝问的是"什么",他们回答的却是"为什么".上帝询问事实,他们回答理由.**而且,两人都深信,列举原因可以以某种方式美化他们的行为.他们是从哪里得到这样的想法的? 对我来说,这一细节有三个深刻的含义:首先,人类在进化早期就意识到世界并非由枯燥的事实(我们今天可能称之为数据)堆砌而成;相反,这些事实是通过错综复杂的因果关系网络融合在一起的.其次,因果解释而非枯燥的事实构成了我们大部分的知识,它应该成为机器智能的基石.最后,我们从数据处理者向因果解释者的过渡不是渐进的,而是一次"大跃进",借助的是某种奇异的外部推力.这与我在因果关系之梯上的理论观察完全吻合:没有哪台机器可以从原始数据中获得解释.对数据的解释需要借助外部推力.
39. 事实上,我在机器学习方面的研究经历告诉我,因果关系的学习者必须熟练掌握至少三种不同层级的认知能力:**观察能力(seeing),行动能力(doing)和想象能力(imagining).**
40. **第一层级是观察能力,具体而言是指发现环境中的规律的能力.**在认知革命发生之前,这种能力为许多动物和早期人类所共有.**第二层级是行动能力,涉及预测对环境进行刻意改变后的结果,并根据预测结果选择行为方案以催生出自己期待的结果.**只有少数物种表现出了具备此种能力的特征.对工具的使用(前提是使用是有意图的,而不是偶然的或模仿前人)就可以视作达到第二层级的标志.然而,即使是工具的使用者也不一定掌握有关工具的"理论",工具理论能够告诉他们为什么这种工具有效,以及如果工具无效该怎么做.为掌握这种理论,你需要登上想象力这一层级.**第三层级至关重要,它让我们为发起农业领域和科学领域的更深层次的革命做好了准备,使得我们人类对于地球的改造能力发生了骤变.**
41. 处于第一层级的是关联,在这个层级中我们通过观察寻找规律.一只猫头鹰观察到一只老鼠在活动,便开始推测老鼠下一刻可能出现的位置,这只猫头鹰所做的就是通过观察寻找规律.
    * 相关性
42. 有些关联可能有明显的因果解释,有些可能没有.但无论如何,统计学本身并不能告诉我们,牙膏或牙线哪个是因,哪个是果.从销售经理的角度看,这件事也许并不重要——好的预测无须好的解释,就像猫头鹰不明白老鼠为何总是从A点跑到B点,但这不改变它仍然是一个好猎手的事实.
    * 就像大数据里经典案例"啤酒和纸尿裤".
43. 我完全赞同纽约大学神经系统科学家盖里·马库斯的观点,他最近在<纽约时报>上写道:人工智能领域"喷涌出大量的微发现",这些发现也许是不错的新素材,但很遗憾,机器仍与类人认知相去甚远.
44. 与30年前一样,当前的机器学习程序(包括那些应用深度神经网络的程序)几乎仍然完全是在关联模式下运行的.它们由一系列观察结果驱动,致力于拟合出一个函数,就像统计学家试图用点集拟合出一条直线一样.**深度神经网络为拟合函数的复杂性增加了更多的层次,但其拟合过程仍然由原始数据驱动.被拟合的数据越来越多,拟合的精度不断提高,但该过程始终未能从我们先前提到的那种"超进化加速"中获益.**
45. **当我们开始改变世界的时候,我们就迈上了因果关系之梯的更高一层台阶.**这一层级的一个典型问题是:"如果我们把牙膏的价格翻倍,牙线的销售额将会怎么样?"这类问题处于因果关系之梯的第二层级,提出及回答这类问题要求我们掌握一种脱离于数据的新知识,即干预.
46. **干预比关联更高级,因为它不仅涉及被动观察,还涉及主动改变现状.**
47. 反事实与数据之间存在着一种特别棘手的关系,因为数据顾名思义就是事实.数据无法告诉我们在反事实或虚构的世界里会发生什么,在反事实世界里,观察到的事实被直截了当地否定了.然而,人类的思维却能可靠地,重复地进行这种寻求背后解释的推断.当夏娃把"蛇欺骗了我"作为她的行动理由时,她就是这么做的.这种能力彻底地区分了人类智能与动物智能,以及人类与模型盲版本的人工智能和机器学习.
48. 你可能会怀疑,对于"假如"(would haves)这种并不存在的世界和并未发生的事情,科学能否给出有效的陈述.科学确实能这么做,而且一直就是这么做的.
49. 从想象的反事实中,我们获得的独特优势是灵活性,反省能力和改善过去行为的能力,更重要的一点是对过去和现在的行为承担责任的意愿.古往今来,我们一直受益于反事实推理.
51. 智能."儿童的大脑与我们从文具店购买的空白笔记本相差无几,"他写道,"预先设定的机制极少,有着大量的空白."在这一点上,图灵错了:儿童的大脑有着丰富的预设机制和预存模板.
    * 孩子的大脑不是白板, 更准确说是在智力, 认知, 推理能力上不是白板. 在道德, 社会上是一个白板.
52. 显然,在让机器进行迷你图灵测试的准备阶段,表示问题必须优先于获取问题.如果缺少表示方法,我们就不知道如何存储信息以供将来使用.
53. 换句话说,塞尔的问题清单需要列出的条目将超过宇宙中原子的数量.所以,很显然,简单的问题答案列表永远无法让机器模拟儿童的智能,更不用说模拟成人的智能了.
    * 这里是在反驳"中文屋"这个思考实验.
54. 此外,一旦我们完成了之前的分析工作,并从数据中找到了估算疫苗接种能带来多大益处的方法,我们就不必在条件改变时从头开始重复整个分析过程.如导言所述,同样的被估量(也就是回答相应问题的方法)将一直有效,并且只要因果图不变,该被估量就可以应用于新数据,并为特定问题生成新的估计值.我猜想,正是由于具备这种稳健性,人类的直觉才以因果关系而非统计关系为组织的核心.
55. *哲学家几乎无一例外地使用了条件概率来表示"X提高了Y的概率",记作`P(Y|X)>P(Y)`.你肯定注意到了,这种解释是错的,**因为"提高"是一个因果概念**,意味着X对Y的因果效应,而公式`P(Y|X)>P(Y)`**只涉及观察和手段**,表示的是"如果我们观察到了X,那么Y的概率就提高了".但是,这种概率提高完全可能是由其他因素造成的,比如Y是X的因,或者其他变量(Z)是它们二者的因——这就是症结所在!这一形式表述将哲学家们打回原点,让他们不得不再一次尝试消除可能存在的"其他原因".*
56. 换句话说,一旦用条件概率的语言歪曲"概率提高",即使再多的概率补丁也无法让你登上更高一层的因果关系阶梯.
57. 因此,正如我将在第三章中解释的那样,我创建了一种关于不确定性的推理方法,名为"贝叶斯网络",用于模拟理想化的,去中心化的人类大脑将概率纳入决策的方法.贝叶斯网络可以根据我们观察到的某些事实迅速推算出某些其他事实为真或为假的概率.
58. 在我1988年的著作<智能系统中的概率推理>(Probabilistic Reasoning in Intelligent Systems )中,我写道:"因果关系是一种语言,运用这种语言,人们可以有效谈论关联关系的某些结构."如今,这句话令我备感尴尬,因为"关联"显然是第一层级的概念.实际上在此书出版时,我在心里已经意识到自己错了.对我的计算机科学家同行来说,我的书被视为不确定性下推理的圣经,而我自己却变成一个叛教者.
59. 在此,我想说明的主要观点是:概率能将我们对静态世界的信念进行编码,而因果论则告诉我们,当世界被改变时,无论改变是通过干预还是通过想象实现的,概率是否会发生改变以及如何改变.
60. 作为对高尔顿的故事发表的最后一点个人评论,我承认我犯了历史写作的一项大忌,这也是我在本书中犯下的许多大忌之一.20世纪60年代,像我上面那样以现代科学的视角来书写历史的做法已经过时了.**"辉格史观"(Whig history)就是一个针对此种做法的批判性术语,用于嘲弄事后诸葛亮式的历史写作风格——只关注成功的理论和实验,而对失败的实验和陷入僵局的理论发展几乎只字不提.**
    * 失败可能比成功更重要
61. 许多人仍然会犯尼尔斯的错误,认为因果分析的目的只是证明X是Y的因或从头开始找到Y的因.这的确是因果关系研究中的因果发现难题,也是我第一次投身于图形化建模时雄心勃勃地试图解决的问题,直到现在,这依然是一个充满活力的研究领域.
62. 克洛指出了一个关键点:路径分析需要建立在科学思考的基础上,因果推断的每一次实践也都需要建立在科学思考的基础上.而统计学则一如既往地打压这种做法,鼓励采用"固定程序"解决问题.统计学家总是喜欢针对数据进行常规性的计算,而不喜欢接受那些挑战了他们已有知识体系的方法.
63. **`P(S|T)P(T)=P(T|S)P(S)` 这个看似简单的方程就是贝叶斯法则.** 如果仔细观察它所表达的内容,我们就能发现它提供了逆概率问题的一种通用解决方案.它告诉我们,如果我们知道给定T后S的概率,即`P(S|T)`, 那么我们就应该能够计算出给定S后T的概率,即`P(T|S)`,当然前提是我们已知`P(T)`和`P(S)`.这也许是贝叶斯法则在统计学中最重要的应用:我们可以在我们的判断较为可靠的一个方向上直接估算出条件概率,并利用数学工具推导出在我们的判断较为模糊的另一方向上的条件概率.在贝叶斯网络中,该方程也扮演了同样的角色:我们告诉计算机前向概率,在需要时,计算机告诉我们逆概率.
64. 从哲学的角度来看,托马斯·贝叶斯的成就在于他首次提出了条件概率的正式定义,即`P(S|T)=P(S且T)/P(T)`.但应当承认,他的阐释是晦涩的,他没有使用"条件概率"这个术语,而是使用"假设第一个事件发生了,第二个(事件)发生的概率"这种烦琐的描述.直到19世纪80年代,人们才意识到"假设"这种关系需要有它自己的表示符号.最终,哈罗德·杰弗里(多以地球物理学家而非概率论学者的身份为人所知)于1931年正式提出了现在我们在`P(S|T)`中使用的标准竖线表示符号.
65. 神迹越是不可思议,在神迹发生后可以解释它为何发生的假设就越可信.
66. 1.`A→B→C`.这种接合形式是被称为"链"接合或中介接合的最简单的表现形式.在科学中,人们常常将B视为某种机制,或"中介物",它将A的效应传递给C.
67. 在介绍完只包含一个连接的两节点网络后,我们的下一步自然是引入包含两个连接的三节点网络,我称此种网络为"接合"(junction).这是所有贝叶斯网络(以及因果网络)的构建模块.接合有三种基本类型或形式,借助这些基本形式,我们就可以在网络中表征出所有的箭头模式.
69. 2.`A←B→C`.这种接合形式被称为"叉"接合,B通常被视作A和C的共因(common cause)或混杂因子(confounder).混杂因子会使A和C在统计学上发生关联,即使它们之间并没有直接的因果关系.一个好例子(来自大卫·弗里德曼)是"鞋的尺码←孩子的年龄→阅读能力".穿较大码的鞋的孩子往往阅读能力较强.
70. 3.`A→B←C`.这是最让人着迷的一种接合形式,被称作"对撞"(collider)接合.菲利克斯·艾尔威特和克里斯·文史普以好莱坞演员的三个特征为例阐释了这个接合的含义.这个例子是:才华→名人←美貌.在此,我们认定才华和美貌都有助于演员的成功,但对于一般人而言,美貌和才华完全不相关.
    * 现成为名人后就有用了
71. 可以看到,当我们以中间的变量B为条件时,这种对撞接合的运作方式与链接合或叉接合正好相反.如果A和C原本是相互独立的,那么给定B将使它们彼此相关.例如,如果我们只选取著名演员的数据(换言之,我们现在只观察"名人=1"的数据),那么我们就会看到才华与美貌之间出现了负相关,这种负相关可以解释为:发现某位名人并不美貌这一事实,会使我们更相信他富有才华.
72. 即使这个例子只是一个有3个节点的小型网络,它仍然包含`2×11=22`个父状态,且其中的每一个都为子状态的概率做出了贡献.然而,对于计算机来说,这样的计算只是非常初级的运算(在一定意义上我们可以这么说).当然,如果这种运算不是以系统化的方式完成的,那么过高的运算次数仍然会压垮速度最快的超级计算机.如果一个节点有10个父节点,且每个父节点都有2个状态,则条件概率表将超过1000行.如果10个父节点中的每一个都有10个状态,那么这张表将有100亿行!为此,人们通常会对网络中的连接进行筛选,只保留那些最重要的连接,让网络保持一个相对"稀疏"的状态.在贝叶斯网络的发展过程中,其中一项技术成果就是开发出了一种方法让我们可以利用网络结构的稀疏性实现合理的计算时间.
73. 贝叶斯网络的透明性使它有别于机器学习的其他模型,后者多倾向于制造高深莫测的"黑箱".在贝叶斯网络中,你可以一个节点接一个节点地追踪,了解每一个新的证据是如何以及为何改变了整个网络中各个连接的信念的.
74. 尽管波拿巴已经足够简洁优雅了,但必须指出的是,它仍然有一个缺陷:欠缺人类的直觉.一旦分析工作完成,它就可以为法医研究所的专家提供每个DNA样本与家谱中的各个节点的匹配程度(用似然比来表示)从高到低的排名.然后,调查人员就可以将DNA证据与从坠机现场搜集到的其他物证以及他们的直觉进行自由结合,做出最终决定.目前为止,还没有哪一种识别工作是由计算机独立完成的.而因果推断科学的一个目标就是创建更顺畅的人机接口,比如将调查人员的直觉也纳入信念传播的计算过程.
75. 1993年,一位名叫克劳德·贝鲁的法国电信工程师震惊了编码世界,他开发的纠错码表现出了近乎最优的性能.(换言之,其所需的冗余信息的数量接近于理论最小值.)他的构思被称为"turbo码",非常适用于通过贝叶斯网络来解释.
76. 其次,因果图的图形属性决定了哪些因果模型可以借助数据来区分,哪些模型永远无法借助数据来区分,无论数据集有多大.例如,仅靠数据我们不能区分叉接合`A←B→C`与链接合`A→B→C`,因为这两种接合的因果图有相同的条件独立性.
77. 发明于20世纪90年代的因果图方法已经完全解决了混杂问题.特别是我们很快就会介绍的一种被称为"后门标准"(back-door criterion)的方法,它可以明确识别出因果图中哪些变量是去混因子.
78. 当一个变量同时影响到选择接受处理的对象以及试验结果时,混杂偏倚就产生了.有时混杂因子是已知的,另一些时候它们只是疑似存在,在分析中以"潜伏的第三变量"出现.在因果图中,混杂因子非常容易识别.在图4.1中,位于这个叉接合中心的变量Z就是X和Y的混杂因子.(稍后我们将看到一个对于混杂因子的更通用的定义,但这个三角形是最容易识别,也是最常见的一种情况.)
79. 然而,如果我们允许试验者使用自己的判断选择肥料或试验对象,那么试验就无法达到模拟模型2的目标.在这种情况下,农作物就能"读懂"它们对应的抽签结果了.对人类受试者进行临床试验时,研究者必须不遗余力地向病人和主试隐瞒处理信息(该试验操作被称为双盲试验),其原因正在于此.
80. 现在我们已经明白随机对照试验的主要目的是消除混杂,接下来让我们看看因果革命带来的其他消除混杂的方法.
81. 定义困难的原因就在于混杂并非统计学概念.它代表了我们想要评估的内容(因果效应)和我们实际使用统计方法所评估的内容之间的差异.如果你不能在数学上表达出你想评估的内容,那你就无法定义是什么构成了这种差异.
82. 历史上,"混杂"的概念演变围绕着两个相关概念展开——不可比性和潜伏的第三变量.这两个概念都很"抵制"形式化.
83. 事实上,非因果路径恰恰是混杂的根源.大家应该还记得我将混杂定义为任何使P(Y|do(X))不同于P(Y|X)的因素.do算子会清除指向X的所有箭头,这样它就可以防止有关X的任何信息在非因果方向流动.随机化处理具有相同的效果.如果我们选择合适的变量进行统计调整,那么这种统计调整也具有相同的效果.
84. 当然,我们研究悖论并不只是因为它们是一种有趣的智力游戏.就像视错觉现象一样,它们也揭示了大脑的工作方式,运作捷径以及被大脑认为是互相矛盾的事物.
85. 解决这一悖论的关键是,我们不仅需要考虑数据(主持人打开某个特定门的事实),而且要注意数据生成的过程,也就是游戏规则.数据生成的过程告诉了我们一些关于数据的事实,这些事实是我们本可以观测到但没有观测到的.难怪统计学家对这个谜题的答案尤为不解,因为他们已经习惯了"数据约简"(据费舍尔1922年所言)和忽略数据的生成过程.
    * 三个门
86. 主持人打开的门"是一个对撞因子.一旦我们获得了关于这个变量的信息,图示中所有的概率就都变成了关于这一信息的条件概率.
87. 斯坦福大学的统计学家佩尔西·戴康尼斯于1991年在接受<纽约时报>采访时说:"**我们的大脑的确不能很好地处理概率问题,所以对于错误的出现我并不感到惊讶.**"这句话没错,但事实不止于此.**我们的大脑不擅长处理概率问题,但对因果问题则相当在行.**而这种因果性的思维方式会导致系统性的概率错误,就像视错觉一样.因为"你选的门"和"车的位置"之间没有因果联系(无论这一因果联系是直接的还是由共因带来的),所以我们对于在数据中发现的概率关联就完全无法理解.我们的大脑没有准备好去接受无缘无故的相关性,我们需要经过特殊训练,通过分析和学习如蒙提·霍尔悖论或我们在第三章中讨论的例子,才能辨别出这种相关性可能出现的场合.
88. 赖欣巴哈的错误在于他没有考虑到对撞结构,也即数据选择背后的结构.这个错误对我们来说特别有启发性,因为它精确地说明了我们大脑思考机制的缺陷.**我们在实际生活中似乎就是遵循着共因原则行事的,无论何时,只要观察到某种模式,我们就会去寻找一个因果解释.**事实上,**我们本能地渴望根据数据之外的某个稳定机制对观察结果做出解释.其中最令人满意的解释是直接因果关系:X导致Y.当实际情况不能满足直接因果关系时,如果能找出X和Y的共因,那么我们也会感到满意.**
89. **在最纯粹,最本质的意义上,我们观察到的相关就是一种错觉,甚至可能是一种自欺欺人:我们选择哪些事件进入数据集同时忽略另一些事件的做法给我们自己带来了错觉.重要的是要认识到,我们并非总能意识到自己做出了这个选择,这就是为什么对撞偏倚总是能轻易欺骗那些粗心的人.**在抛掷两枚硬币的试验中,这种选择是有意识的:我明确告诉过你不要记录两枚硬币同为背面朝上的结果.但在很多场合,我们没有意识到我们做出了选择,或者没有意识到选择已经为我们做好了.在蒙提·霍尔悖论中,主持人为我们打开了门;在伯克森的悖论中,一个粗心的研究者可能为了方便而选择以住院病人为研究对象,却没有意识到这种做法为自己的研究带来了偏倚.
    * 这里的硬币指的是同时抛两枚硬币, 只记录包含正的面的结果, 计算第二次背面的概率.
90. <魔鬼数学>(How Not to Be Wrong )中提出的问题:你有没有注意到,在你约会的人当中,那些有魅力的人往往是混蛋?与其为解释这一现象而费力构建复杂的社会心理理论,不如考虑一种更简单的解释.你对约会对象的选择取决于两个因素:魅力和个性.你会冒险约会一个刻薄而有魅力的人,或者一个和蔼但缺乏魅力的人,你当然也会与既和蔼又有魅力的人约会,但你肯定不会与既刻薄又没有魅力的人约会.换句话说,你删掉了所有"负—负"的结果,这与你在抛掷两枚硬币的例子中所做的筛选是相同的,而正是这种筛选造成了魅力和个性之间的伪负相关.可悲的事实是,没有魅力的人可能会和有魅力的人一样刻薄,但你永远意识不到这一点了,因为你永远不会约会既刻薄又没有魅力的人.
91. **我们应该看的是故事的因果结构,而不仅仅是时序信息.**
    * "因果"这个词有天然的时序性. 可观察到因果性的所产生时序和真实时间并不一定相同的.
92. 在1995年发表的一份关于甲状腺疾病的研究报告中,数据显示吸烟者的存活率(76%)比不吸烟者的存活率(69%)更高,寿命平均多出20年.然而,在样本的7个年龄组中,有6个年龄组中不吸烟者的存活率更高,而第7个年龄组中二者的差异微乎其微.年龄显然是吸烟和存活率的混杂因子:吸烟者的平均年龄比不吸烟者小(很可能是因为年老的吸烟者已经死了).根据年龄来分割数据,我们就可以得出正确的结论:吸烟对存活率有负面影响.
    * 这里有一组数据是对统计数据最好的反对. [安斯库姆四重奏](https://github.com/zoroqi/hacker-laws-zh/tree/self#%E5%AE%89%E6%96%AF%E5%BA%93%E5%A7%86%E5%9B%9B%E9%87%8D%E5%A5%8F-anscombes-quartet) [wiki](https://zh.wikipedia.org/wiki/%E5%AE%89%E6%96%AF%E5%BA%93%E5%A7%86%E5%9B%9B%E9%87%8D%E5%A5%8F)
93. 比较而言,**规律性是可以观察到的,而反事实只能凭想象生成.**
94. 我仍然记得当时我的学生丹·盖革怀疑地问道:"**确定性方程?真正的确定性吗?**"
95. 但是在法律界,将反事实作为论据的做法实际上历史悠久,其被称为"若非因果关系". <模范刑法典> 是这样解释"若非"测试的:"行为是导致结果的原因,其前提是:(a)行为是一个先行项,若非它,结果就不会发生."假如被告开了一枪,击中并杀死了受害者,则开枪射击就是受害者死亡的"若非因"或必要因,因为假如被告没有开枪,受害者就不会死."若非因"也可以是间接的.假设乔用家具挡住了大楼的消防通道,而朱蒂在发现无法从出口出去之后死在了大火中,那么即使乔不是点火的人,他对她的死也负有法律责任.
96. 在我们日常所使用的语言中,**"为什么"这个问题至少有两个版本.第一个直截了当:你看到一个果,想知道因.**
97. **但"为什么"还有第二个版本,在这个版本中,我们提出这个问题是为了更好地了解已知的因和已知的果之间的联系,**
98. **我们就会提出这个问题.人类永不满足,总是想知道更多.在发现上述事实后不久,我们就会开始问第二个版本的问题:"为什么**
99. 据我所知,第一个明确用因果图来表示中介物的人是斯坦福大学的一名研究生,名叫**巴巴拉·伯克斯,她提出这一表示法的时间是1926年.这位鲜为人知的女性科学先驱是本书真正的幕后英雄之一.**我们有理由相信,她实际上是独立于休厄尔·赖特发明了路径图.在中介方面,她不仅走在了赖特的前面,而且领先她的时代几十年.
100. **一个令他们自己非常满意的因果叙述.他们在1975年的<科学>杂志上发表了一篇文章,其中提出了一个对这一悖论的简单解释:女生申请者被拒绝的人数更多,是因为她们倾向于申请更难被录取的系. 具体而言,一方面,在人文科学和社会科学系的申请中,女性申请者所占比例要高于男性,而在这些院系中,她们面临着双重困境:申请者数量更多,而录取名额更少.另一方面,女生不怎么申请像机械工程学这样的系,但这些系本身录取的学生更多,且系里为研究生提供了更多的资金和空间,简而言之,这些系的录取率更高. 那么,为什么女性会倾向于申请更难录取的系?她们没有选择申请技术性领域的院系,也许是因为那些领域对数学水平的要求较高,或被认为更"男性化".也许是因为她们在教育的早期阶段遭到了歧视,就像巴巴拉·伯克斯的故事所显示的那样,社会往往倾向于将女性从技术性领域排挤出去.但这些因素并不在伯克利大学的控制之中,因此不能视作大学存在性别歧视的证据.毕克尔和汉默尔的结论是:"伯克利大学并没有歧视女性申请者."**
    * 经典的"[辛普森悖论](https://zh.wikipedia.org/zh-hans/%E8%BE%9B%E6%99%AE%E6%A3%AE%E6%82%96%E8%AE%BA)"的一个合理解释.
101. 聪明如我当然不会将决定权交给最高法院,而是留给自己的妻子.为何我的妻子有如此强烈的直觉,认为在每个院系都公平行事的情况下,整所学校就完全不可能存在歧视呢?这涉及了一个类似于确凿性原则的因果运算定理.正如吉米·萨维奇在最初提出这一原则时所说的那样,确凿性原则属于总效应,而这个因果运算定理则适用于直接效应.总体的直接效应据其定义就应取决于子总体直接效应的总和. 简言之,每个局部的公平就意味着总体的公平.我的妻子是对的.
102. 巴伦—肯尼方法受到了空前的欢迎,无疑源于以下两个因素.首先,人们对中介效应的计算有很大的需求.我们想要理解"自然的作用机制"(在`X→M→Y`中找到那个M)的渴望也许比我们想要量化它的渴望更强.其次,该方法很容易简化为一个基于统计学中一些我们所熟知的概念的标准步骤.
103. 一个是对的?都不对!两组研究人员都混淆了步骤和意义.步骤是数学的,意义是因果的.事实上,深入挖掘这个问题你将发现:在线性模型之外,间接效应对回归分析来说就不再有意义了,其仅剩的意义就是代数步骤的结果("路径系数的乘积").一旦撤走步骤本身,它们就会像一艘没有锚的小船一样随波逐流.
104. 直到后来我才意识到,受此种反常现象困扰的不只是人工智能领域.**科学家本应是最关心"为什么"的人,但由于他们长期束缚于统计学的工作氛围,其提问"为什么"的正当权利被剥夺了.**当然,无论如何,科学家还是会提出关于"为什么"的问题,但每当他们想用数学分析来解决这一问题时,他们就不得不将这一问题转化为一个关于关联的伪问题.
105. 数据体量越来越庞大,但我们问的问题始终很简单:是否存在一种会导致肺癌的基因?什么样的恒星系可能存在像地球一样的行星?是什么因素导致了我们喜爱的某种鱼类的数量减少,而对此我们能做些什么?
    * 鱼类数量的减少这个问题很好解答. 因为人类的存在, 人的好恶.
106. 并非所有人工智能领域的研究者都反对这一认为系统"缺乏透明性"的观点.当时,该领域的研究者分成了两派——**"讲究派"(这些人寻求的是建立有运行保障的,足够透明的系统)和"将就派"(这些人对系统的要求是只要可运行,满足工作目的即可)两类**,而我一直属于"讲究派".
107. 我很幸运能在这一领域准备好接受新方法的时候参与进来.贝叶斯网络是概率的,它可以应对充满矛盾和不确定数据的世界.而基于规则的系统则不同,它们是模块化的,易于在分布式计算平台上编码,这让它们运行得很快.最后,对我(以及其他"讲究派"的学者)来说,重要的是,贝叶斯网络以数学的方式可靠地处理概率,这就保证了即便出了什么差错,该差错也只会出现在程序中,而不会出现在我们的思想里.
108. 当我们开始谈论强人工智能时,因果模型就从奢侈品变成了必需品.对我来说,强人工智能应该是能反思其行为,并能从过去的错误中吸取教训的机器.它应该能够理解"我本应该采取不同的行为"这句话,无论这句话是由人类告诉它的还是由它自己分析得出的.
    * 感觉是反脆弱的开始
109. **但这又引发了新的问题:假设自由意志是(或者可能是)一种幻觉,那么为什么对我们人类来说,拥有这种幻觉如此重要?为什么进化过程不辞辛劳地赋予我们这个概念?不管是不是在制造噱头,我们是否都应该尝试着给下一代计算机编写程序,让它们拥有这种幻觉?这样做的目的何在?它带来了哪些计算优势? 我认为,理解自由意志幻觉的功能是解开它如何才能与决定论相调和这一深奥谜题的关键.而一旦我们赋予一台确定性机器同样的功能,问题就会迎刃而解.**
110. **除了功能问题,我们还必须处理模拟问题.如果是大脑中的神经信号引发了我们所有的行动,那么我们的大脑就一定会忙于用"意志"或"有意"来美化某类行动,而用"无意"来美化另一类行动.那么,这个贴标签的过程到底是什么?什么样的神经路径会得到带有"意志"标签的特定信号?**
111. 目前,人工智能领域的研究者正试图回答这两个问题,即功能问题和模拟问题,其中前者驱动了后者.一旦认识到自由意志在我们的生活中发挥了怎样的计算功能,我们就可以给机器配备这样的功能.如此,这两个问题就被转化为一个工程问题,虽然解决这一工程问题仍然非常困难.
112. 在这一点上,就像那些国际象棋选手和围棋选手一样,我们甚至可以向自己所创造的事物学习.在未来,我们可以依靠机器来寻求明察秋毫,因果合理的正义,我们将进一步了解人类自身的自由意志"软件"是如何运作的,以及它是如何对人类自身隐藏其工作原理的.这种会思考的机器将成为人类的良师益友,而这正是人工智能送给人类的第一份,也是最好的一份礼物.

## 笔记

### 理解
* 作者介绍: 朱迪亚·珀尓(Judea Pearl)，现加州大学洛杉矶分校计算机科学教授，“贝叶斯网络”之父，2011年因创立因果推理演算法获得图灵奖，同时也是美国国家科学院院士，IEEE智能系统名人堂第一批10位入选者之一。 达纳·麦肯齐(Dana Mackenzie)，普林斯顿大学数学博士，自由科学记者，知名科普作家，著有《无言的宇宙》等作品，其学术论文多次收录于《科学》《新科学家》《科学美国》《探索》等重量级期刊。算上这个本我读过或拥有的图灵奖作者的著书已经有3部了, 但只有一个能看完, 剩下的都是能力所不及导致无法阅读. 这本其实也有不少部分是跳过的.
* [辉格史](https://zh.wikipedia.org/zh/%E8%BE%89%E6%A0%BC%E5%8F%B2) 辉格史观: 这个党派的历史学家对历史的解释往往从今天的角度出发，来评判历史事件的价值。在科學史中，這個術語也常用來表示研究得出當今科學觀點的“成功的”理論與實驗的史學史派別
* **你无法回答一个你提不出来的问题,你也无法提出一个你的语言不能描述的问题.** 这句话很重要, 任何事情都需要一个合适的语言去表达. 这里就是将思维符号化, 将思维限制在一定范围内. 而创新就要超越固有的符号.
* 这里对因果定义了三个阶梯 ^715655
    1. 观察能力, 发现事物之间的相关性
    2. 行动力, **主动干预事物**. 预测对环境进行刻意改变后的结果
    3. 想象能力, **反事实**. 假如做了X会发生Y, 如果没有做X会怎么样. 对过去行为改善的能力.
* 三个阶梯的典型问题 ^c77d88
    1. **观察能力, "我观察到......会怎样?"**
    2. **行动力, "怎样做?"和"如果我们实施......行动, 将会怎样?"**
    3. **想象力, "假如我当时做了....会怎么样?"和"为什么?"**
* 我对这三个层次的理解. ^e0ab30
    1. 观察, 可以理解为收集数据, 发现可能的"关系", 利用固有"关系"实现自己的目的.
    2. 行动力, 对发现的"关系"进行主动干预, 改变"关系"内的原因, 对结果进行分析.
    3. 想象力, 一种反思, 一种对没有发生事情的预测. 对行动产生的结果进一步分析, 找到对不符合预期的情况, 返回第一层进行再次循环.
* 三种逻辑形式 ^nbh672i
    1. `A->B->C`, B视为某种机制, 或"中介物",它将A的效应传递给C
    2. `A<-B->C`, B是A和C的共因, 或B的存在是A和C产生了相关性
    3. `A->B<-C`, B存在后, A和C出现负相关.
* 讲究派"(这些人寻求的是建立有运行保障的,足够透明的系统)和"将就派"(这些人对系统的要求是只要可运行,满足工作目的即可)
    * 受产品进度压迫的程序员就是"将就派"
* 值得深思的问题.
    1. 假设自由意志是(或者可能是)一种幻觉,那么为什么对我们人类来说,拥有这种幻觉如此重要?
    2. 为什么进化过程不辞辛劳地赋予我们(自由意志的幻觉)这个概念?
    3. 对"有意"和"无意"之间如何进行区分? 这个区分过程是什么?
* 对"基于统计学的人工智能"持一种否定态度. 统计学只能发现事件之间的相关性, 并无法找到因果性. 所以很多基于大数据训练出来的模型经常会出现特殊的bug, 这就是某种拟合错误引起的. 我个人观点是只要数据量足够基于统计就没啥问题, 当然这个数据量是巨大的. 生物视觉系统是基于几亿年, 无数的生物所演化出来的, 想训练出一个通用的视觉系统, 不应该相差太多数量级.
